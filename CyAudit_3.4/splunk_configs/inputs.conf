# CyAudit Splunk Configuration - inputs.conf
# Version: 1.1
# Purpose: Data input configuration for CyAudit data ingestion

################################################################################
# RECOMMENDED: Universal Forwarder File Monitoring Configuration
################################################################################
# Deploy this configuration to Universal Forwarder on the Windows system
# where CyAudit runs and Transform-CyAuditForSplunk.ps1 generates output.
#
# Location on Windows: C:\Program Files\SplunkUniversalForwarder\etc\system\local\inputs.conf

[monitor://C:\CyAudit\SplunkReady\*.json]
disabled = false
index = cyaudit
sourcetype = cyaudit:auto
recursive = false
whitelist = \.json$
followTail = 0
ignoreOlderThan = 14d

# Optional: Archive or delete files after forwarding
# move_policy = sinkhole

# CRC settings for file tracking
crcSalt = <SOURCE>
initCrcLength = 1024

# Optional: Monitor transformation script logs
[monitor://C:\CyAudit\SplunkReady\*.log]
disabled = true
index = cyaudit
sourcetype = cyaudit:script_log
recursive = false
whitelist = \.log$

################################################################################
# Universal Forwarder Outputs Configuration
################################################################################
# This should be in outputs.conf on the Universal Forwarder
#
# [tcpout]
# defaultGroup = splunk_cloud_cyaudit
#
# [tcpout:splunk_cloud_cyaudit]
# server = inputs.yourinstance.splunkcloud.com:9997
#
# # SSL configuration for Splunk Cloud
# [tcpout-server://inputs.yourinstance.splunkcloud.com:9997]
# sslCertPath = $SPLUNK_HOME\etc\auth\server.pem
# sslRootCAPath = $SPLUNK_HOME\etc\auth\cacert.pem
# sslPassword = <encrypted_password>
# sslVerifyServerCert = true
#

################################################################################
# ALTERNATIVE: HTTP Event Collector (HEC) Configuration for Splunk Cloud
################################################################################
# Use this if you cannot deploy a Universal Forwarder and need manual uploads
# via the Upload-ToSplunkCloud.ps1 script.

# [http]
# # Enable HEC
# disabled = 0
#
# # HEC Global Settings
# enableSSL = 1
# port = 8088
# dedicatedIoThreads = 2
#
# [http://cyaudit_hec_token]
# # CyAudit HEC Token Configuration
# # Generate token in Splunk Cloud: Settings > Data Inputs > HTTP Event Collector
#
# disabled = 0
# token = <REPLACE_WITH_YOUR_HEC_TOKEN>
# index = cyaudit
# indexes = cyaudit
#
# # Sourcetype routing (automatic based on event.sourcetype field)
# sourcetype = _json
#
# # Use acknowledgment for reliability
# useACK = 1
#
# # Description for management
# description = CyAudit Opus v3.4 Security Assessment Data

################################################################################
# Linux/Unix File Monitor (For non-Windows deployments)
################################################################################
# Uncomment if deploying on Linux/Unix systems

# [monitor:///opt/cyaudit/SplunkReady/*.json]
# disabled = false
# index = cyaudit
# sourcetype = cyaudit:auto
# followTail = 0
# recursive = false
# whitelist = \.json$
# crcSalt = <SOURCE>
# initCrcLength = 1024

################################################################################
# Notes for Splunk Cloud Users
################################################################################
#
# For Splunk Cloud, you have two options for data ingestion:
#
# OPTION 1: Universal Forwarder (RECOMMENDED for production)
#   Pros:
#   - Automated, continuous monitoring
#   - No manual intervention required
#   - Better throughput and reliability
#   - Supports multiple systems easily
#   - Built-in retry and buffering
#
#   Setup:
#   1. Install Splunk Universal Forwarder on Windows system
#   2. Deploy this inputs.conf to forwarder's local directory
#   3. Configure outputs.conf with your Splunk Cloud details
#   4. Run Transform-CyAuditForSplunk.ps1 to C:\CyAudit\SplunkReady\
#   5. Forwarder automatically detects and forwards new .json files
#
#   File Location: C:\Program Files\SplunkUniversalForwarder\etc\system\local\inputs.conf
#
# OPTION 2: HTTP Event Collector (HEC) - Alternative for manual uploads
#   Pros:
#   - No software installation required
#   - Good for ad-hoc uploads
#   - Simple testing/validation
#
#   Cons:
#   - Requires manual execution
#   - No automatic retry
#   - Must manage script scheduling
#
#   Setup:
#   1. Create HEC token in Splunk Cloud UI:
#      Settings > Data Inputs > HTTP Event Collector > New Token
#   2. Set token name: "CyAudit"
#   3. Select source type: "Automatic"
#   4. Set index: "cyaudit"
#   5. Enable "Indexer Acknowledgment"
#   6. Copy the token value
#   7. Use Upload-ToSplunkCloud.ps1 script:
#      .\Upload-ToSplunkCloud.ps1 -Path ".\SplunkReady" `
#        -HecToken "YOUR-TOKEN" `
#        -HecUrl "https://inputs.yourinstance.splunkcloud.com:8088"
#
# RECOMMENDATION: Use Universal Forwarder (Option 1) for all production
# deployments. Reserve HEC (Option 2) for testing or one-off uploads.
#
