# CyAudit Splunk Configuration - indexes.conf
# Version: 1.0
# Purpose: Index definitions for CyAudit data

################################################################################
# CyAudit Security Assessment Index
################################################################################

[cyaudit]
# Main index for CyAudit security assessment data

# Storage settings
homePath = $SPLUNK_DB/cyaudit/db
coldPath = $SPLUNK_DB/cyaudit/colddb
thawedPath = $SPLUNK_DB/cyaudit/thaweddb

# Index sizing and retention
# Adjust based on your data volume and retention requirements
maxTotalDataSizeMB = 10000       # 10 GB default (adjust based on needs)
frozenTimePeriodInSecs = 7776000  # 90 days retention (adjust as needed)

# Hot/warm bucket settings
maxHotBuckets = 3
maxWarmDBCount = 300
maxHotIdleSecs = 86400           # 1 day

# Data integrity and performance
enableDataIntegrityControl = 1
enableTsidxReduction = 1         # Enable TSIDX reduction for search performance
tsidxReductionCheckPeriodInSec = 600

# Compression
# Note: Splunk Cloud handles compression automatically

# Index attributes
datatype = event
repFactor = auto                 # For Splunk Cloud, auto replication

################################################################################
# Optional: Separate Indexes for Different Data Categories
################################################################################
# Uncomment if you want to separate data into multiple indexes

# [cyaudit_compliance]
# # STIG compliance data only
# homePath = $SPLUNK_DB/cyaudit_compliance/db
# coldPath = $SPLUNK_DB/cyaudit_compliance/colddb
# thawedPath = $SPLUNK_DB/cyaudit_compliance/thaweddb
# maxTotalDataSizeMB = 5000
# frozenTimePeriodInSecs = 15552000  # 180 days for compliance

# [cyaudit_inventory]
# # System inventory data (services, features, users, groups)
# homePath = $SPLUNK_DB/cyaudit_inventory/db
# coldPath = $SPLUNK_DB/cyaudit_inventory/colddb
# thawedPath = $SPLUNK_DB/cyaudit_inventory/thaweddb
# maxTotalDataSizeMB = 3000
# frozenTimePeriodInSecs = 7776000   # 90 days

################################################################################
# Notes for Splunk Cloud
################################################################################
#
# For Splunk Cloud deployments:
# 1. Index creation is handled through Splunk Cloud UI or API
# 2. Storage paths (homePath, coldPath, thawedPath) are managed by Splunk
# 3. Replication factor (repFactor) is automatically configured
# 4. Some settings like enableDataIntegrityControl are cloud defaults
#
# To create index in Splunk Cloud:
# 1. Log into Splunk Cloud
# 2. Go to Settings > Indexes
# 3. Click "New Index"
# 4. Index name: "cyaudit"
# 5. Max size of entire index: 10 GB (or as needed)
# 6. Searchable retention: 90 days (or as needed)
# 7. Leave other settings as default
# 8. Click "Save"
#
# Recommended Settings for CyAudit:
# - Index name: cyaudit
# - Max size: 10-50 GB (depending on number of systems and frequency)
# - Retention: 90-365 days (adjust for compliance requirements)
# - Datatype: Events
#
# Storage Estimation:
# - Per system assessment: ~2-5 MB (transformed NDJSON)
# - Weekly assessments of 10 systems: ~10-25 MB/week
# - Monthly retention: ~40-100 MB
# - Annual retention for 10 systems: ~500 MB - 1.25 GB
# - Scale accordingly for your environment
#
# For STIG compliance, consider 180-day or 1-year retention.
#
################################################################################

################################################################################
# Index-Time Field Extraction Settings
################################################################################
# If using index-time extraction (not recommended), configure here:

# [cyaudit]
# # Disable for search-time extraction (recommended)
# # INDEXED_EXTRACTIONS = json
#
# # For search-time extraction, no INDEXED_EXTRACTIONS needed
# # Field extraction happens at search time via KV_MODE=json in props.conf

################################################################################
# Data Model Acceleration (Optional)
################################################################################
# Enable data model acceleration for faster dashboard and reporting

# Acceleration settings are configured per data model, not per index
# See datamodels.conf for acceleration configuration
# Recommended for frequently-accessed dashboards with 1000+ systems

################################################################################
# Volume-Based Index Management (Enterprise Only)
################################################################################
# For Splunk Enterprise deployments with multiple volumes

# [volume:cyaudit_volume]
# path = /opt/splunk/var/lib/splunk/cyaudit_volume
# maxVolumeDataSizeMB = 50000

# [cyaudit]
# homePath = volume:cyaudit_volume/cyaudit/db
# coldPath = volume:cyaudit_volume/cyaudit/colddb
# thawedPath = $SPLUNK_DB/cyaudit/thaweddb

################################################################################
# Archiving and SmartStore (Cloud/Enterprise)
################################################################################
# For long-term retention with SmartStore (Splunk Cloud feature)

# Splunk Cloud automatically configures SmartStore for cost-effective storage
# Older data (cold buckets) are moved to S3-compatible storage
# No additional configuration needed for Splunk Cloud

################################################################################
# Index Sizing Guidelines
################################################################################
#
# Estimate your index size needs:
#
# 1. Per-System Assessment Size (Transformed):
#    - Small environment (workstation): ~1-2 MB
#    - Medium environment (server): ~2-5 MB
#    - Large environment (domain controller): ~5-10 MB
#
# 2. Frequency:
#    - Weekly: Multiply by 52
#    - Monthly: Multiply by 12
#    - Quarterly: Multiply by 4
#
# 3. Number of Systems:
#    - Multiply by system count
#
# Example Calculation:
#    - 50 servers
#    - 3 MB average per assessment
#    - Weekly assessments
#    - 90-day retention
#
#    50 * 3 MB * 13 weeks = 1,950 MB â‰ˆ 2 GB
#    Add 50% buffer = 3 GB total
#
# Adjust maxTotalDataSizeMB accordingly.
#
